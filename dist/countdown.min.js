"use strict";function ownKeys(a,b){var c=Object.keys(a);return Object.getOwnPropertySymbols&&c.push.apply(c,Object.getOwnPropertySymbols(a)),b&&(c=c.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(b,!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(b).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var defaults={endTime:0,totalMilliseconds:0,interval:100,pre:!0,format:"d : h : m : S : s",auto:!0,fixed:!1,lang:"en",themeClass:!1},langMap={en:{d:"days",h:"hours",m:"minutes",S:"seconds",s:"milliseconds"},zh:{d:"\u5929",h:"\u5C0F\u65F6",m:"\u5206\u949F",S:"\u79D2",s:"\u6BEB\u79D2"}},countDown=function(){function a(b,c){_classCallCheck(this,a),this.offset={day:0,hour:0,minute:0,second:0},this.$el=document.querySelector(b),this.options=_objectSpread({},defaults,{},c),this.endTime=Date.now(),this.init()}return _createClass(a,[{key:"init",value:function init(){this._parse(),this.totalMilliseconds=this.endTime-Date.now(),this.options.pre||(this.endTime-=this.options.interval),this.options.auto?this.start():(this.setOffset(),this.render(),this.$el&&this.$el.classList.add("disabled"))}},{key:"start",value:function start(){this.$el&&this.$el.classList.contains("disabled")&&this.$el.classList.remove("disabled"),this.setOffset(),this.render(),this._reCalMilliseconds(),this._continue()}},{key:"_continue",value:function _continue(){var a=Math.min,b=this,c=a(b.totalMilliseconds,b.options.interval);if(!(0<c))b.pause();else if(window.requestAnimationFrame){var d=function(a){e||(e=a),a-e<c?b.requestId=window.requestAnimationFrame(d):b.start()},e=null;b.requestId=window.requestAnimationFrame(d)}else b.timeoutId=setTimeout(function(){b.start()},c)}},{key:"pause",value:function pause(){window.requestAnimationFrame?cancelAnimationFrame(this.requestId):clearTimeout(this.timeoutId),this.$el&&this.$el.classList.add("disabled")}},{key:"end",value:function end(){this.options.fixed?(this.pause(),this.totalMilliseconds=0,this.endTime=0,this.start()):console.log(new Error("end status is invalid!"))}},{key:"reset",value:function reset(){this.options.fixed?(this.endTime=this.options.endTime,this.init()):console.log(new Error("reset status is invalid!"))}},{key:"_reCalMilliseconds",value:function _reCalMilliseconds(){var a=0;a=this.options.fixed?this.totalMilliseconds-this.options.interval:this.endTime-Date.now(),this.totalMilliseconds=100>a?0:a}},{key:"setOffset",value:function setOffset(){var a=Math.floor;this.offset.day=a(this.totalMilliseconds/86400000),this.offset.hour=a(this.totalMilliseconds/3600000)%24,this.offset.minute=a(this.totalMilliseconds/60000)%60,this.offset.second=a(this.totalMilliseconds/1e3)%60,this.offset.millisecond=a(this.totalMilliseconds%1e3/this.options.interval)}},{key:"getOffset",value:function getOffset(){return this._reCalMilliseconds(),this.setOffset(),this.offset}},{key:"_parse",value:function _parse(){var a=parseInt(this.options.totalMilliseconds);if(!isNaN(a)&&0<a)return void(this.endTime=a+Date.now());if(this.isValidDate(this.options.endTime))return void(this.endTime=this.options.endTime.getTime());if("string"==typeof this.options.endTime&&this.options.endTime.indexOf("-")){var b=/^(\d{4})-?(\d{1,2})-?(\d{0,2})[\s]?(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.|\s]?(\d{1,3})?$/,c=this.options.endTime.match(b),d=new Date(c[1],c[2]-1||0,c[3]||1,c[4]||0,c[5]||0,c[6]||0,c[7]||0);if(this.isValidDate(d)){var f=d.getTime();return void(f>Date.now()&&(this.endTime=f))}}var e=parseInt(this.options.endTime);this.endTime=this.isValidDate(new Date(e))?e:0}},{key:"_format",value:function _format(){return this.options.format.replace(/d/,10>this.offset.day?"0"+this.offset.day:""+this.offset.day).replace(/h/,("0"+this.offset.hour).slice(-2)).replace(/m/,("0"+this.offset.minute).slice(-2)).replace(/S/,("0"+this.offset.second).slice(-2)).replace(/s/,""+this.offset.millisecond)}},{key:"isValidDate",value:function isValidDate(a){return"[object Date]"===Object.prototype.toString.call(a)&&!isNaN(a.getTime())}},{key:"getTimeName",value:function getTimeName(a){for(var b=this.options.lang,c=[],d=a.length,e=0;e<d;e+=1)c.push(langMap[b][a[e]]);return c}},{key:"render",value:function render(){if(this.$el){var a="",b=[],c=this.options.format.split(" : "),d=this.getTimeName(c),e=this._format().split(" : "),f=this.options.themeClass;if(f&&0<f.length){for(var g=c.length,h=0;h<g;h+=1)b.push("<div class=\"time-item\">\n            <span class=\"number\">".concat(e[h],"</span>\n            <span class=\"text\">").concat(d[h],"</span>\n          </div>"));a=b.join("<span class=\"separator\">:</span>"),this.$el.classList.add(f)}else a=this._format();this.$el.innerHTML=a}else console.log(this.offset.day,this.offset.hour,this.offset.minute,this.offset.second,this.offset.millisecond)}}]),a}();
